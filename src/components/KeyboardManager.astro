---
import { basics } from "@cv";

const { profiles } = basics;
---

<footer id="normal-footer" class="no-print flex flex-col gap-2">
	<div>
		<!-- Desktop download button will be positioned under profiles section -->
	</div>
</footer>

<div class="desktop-download-section no-print">
	<button 
		id="download-cv-btn" 
		class="download-cv-button"
		onclick="downloadCV()"
	>
		<svg style="margin-right: 8px" width="16" height="16" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
			<path stroke-linecap="round" stroke-linejoin="round" d="M6.72 13.829c-.24.03-.48.062-.72.096m.72-.096a42.415 42.415 0 0 1 10.56 0m-10.56 0L6.34 18m10.94-4.171c.24.03.48.062.72.096m-.72-.096L17.66 18m0 0 .229 2.523a1.125 1.125 0 0 1-1.12 1.227H7.231c-.662 0-1.18-.568-1.12-1.227L6.34 18m11.318 0h1.091A2.25 2.25 0 0 0 21 15.75V9.456c0-1.081-.768-2.015-1.837-2.175a48.055 48.055 0 0 0-1.913-.247M6.34 18H5.25A2.25 2.25 0 0 1 3 15.75V9.456c0-1.081.768-2.015 1.837-2.175a48.041 48.041 0 0 1 1.913-.247m10.5 0a48.536 48.536 0 0 0-10.5 0m10.5 0V3.375c0-.621-.504-1.125-1.125-1.125h-8.25c-.621 0-1.125.504-1.125 1.125v3.659M18 10.5h.008v.008H18V10.5Zm-3 0h.008v.008H15V10.5Z" />
		</svg>
		Download CV
	</button>
</div>

<div class="mobile-download-button no-print">
	<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
		<path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
		<path d="M4 17v2a2 2 0 0 0 2 2h12a2 2 0 0 0 2 -2v-2" />
		<path d="M7 11l5 5l5 -5" />
		<path d="M12 4l0 12" />
	</svg>
	<span>CV</span>
</div>

<script>
	function downloadCV() {
		try {
			const link = document.createElement('a');
			link.href = '/Esclender-Lugo_CV_2024.es.pdf';
			link.download = 'Esclender-Lugo_CV_2024.es.pdf';
			link.click();
		} catch (error) {
			console.error('Error downloading CV:', error);
		}
	}

	// Function to update button text based on detected language
	function updateButtonText() {
		const downloadBtn = document.getElementById('download-cv-btn');
		if (downloadBtn) {
			// Check if the page content contains Spanish text
			const pageText = document.body.textContent || '';
			if (pageText.includes('Descargar') || pageText.includes('Acerca') || pageText.includes('Experiencia')) {
				downloadBtn.innerHTML = `
					<svg style="margin-right: 8px" width="16" height="16" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
						<path stroke-linecap="round" stroke-linejoin="round" d="M6.72 13.829c-.24.03-.48.062-.72.096m.72-.096a42.415 42.415 0 0 1 10.56 0m-10.56 0L6.34 18m10.94-4.171c.24.03.48.062.72.096m-.72-.096L17.66 18m0 0 .229 2.523a1.125 1.125 0 0 1-1.12 1.227H7.231c-.662 0-1.18-.568-1.12-1.227L6.34 18m11.318 0h1.091A2.25 2.25 0 0 0 21 15.75V9.456c0-1.081-.768-2.015-1.837-2.175a48.055 48.055 0 0 0-1.913-.247M6.34 18H5.25A2.25 2.25 0 0 1 3 15.75V9.456c0-1.081.768-2.015 1.837-2.175a48.041 48.041 0 0 1 1.913-.247m10.5 0a48.536 48.536 0 0 0-10.5 0m10.5 0V3.375c0-.621-.504-1.125-1.125-1.125h-8.25c-.621 0-1.125.504-1.125 1.125v3.659M18 10.5h.008v.008H18V10.5Zm-3 0h.008v.008H15V10.5Z" />
					</svg>
					Descargar CV
				`;
			} else {
				downloadBtn.innerHTML = `
					<svg style="margin-right: 8px" width="16" height="16" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
						<path stroke-linecap="round" stroke-linejoin="round" d="M6.72 13.829c-.24.03-.48.062-.72.096m.72-.096a42.415 42.415 0 0 1 10.56 0m-10.56 0L6.34 18m10.94-4.171c.24.03.48.062.72.096m-.72-.096L17.66 18m0 0 .229 2.523a1.125 1.125 0 0 1-1.12 1.227H7.231c-.662 0-1.18-.568-1.12-1.227L6.34 18m11.318 0h1.091A2.25 2.25 0 0 0 21 15.75V9.456c0-1.081-.768-2.015-1.837-2.175a48.055 48.055 0 0 0-1.913-.247M6.34 18H5.25A2.25 2.25 0 0 1 3 15.75V9.456c0-1.081.768-2.015 1.837-2.175a48.041 48.041 0 0 1 1.913-.247m10.5 0a48.536 48.536 0 0 0-10.5 0m10.5 0V3.375c0-.621-.504-1.125-1.125-1.125h-8.25c-.621 0-1.125.504-1.125 1.125v3.659M18 10.5h.008v.008H18V10.5Zm-3 0h.008v.008H15V10.5Z" />
					</svg>
					Download CV
				`;
			}
		}
	}

	// Set up mobile download button
	function setupMobileDownloadButton() {
		const mobileBtn = document.querySelector('.mobile-download-button');
		if (mobileBtn) {
			mobileBtn.addEventListener('click', downloadCV);
		}
	}

	// Set up when DOM is ready
	if (document.readyState === 'loading') {
		document.addEventListener('DOMContentLoaded', () => {
			setupMobileDownloadButton();
			updateButtonText();
		});
	} else {
		setupMobileDownloadButton();
		updateButtonText();
	}
</script>

<style>
	@keyframes fadeIn {
		from {
			opacity: 0;
		}
		to {
			opacity: 1;
		}
	}

	/* Default state - hide mobile button */
	.mobile-download-button {
		display: none;
	}

	/* Desktop styles */
	@media (min-width: 601px) {
		.mobile-download-button {
			display: none;
		}

		#normal-footer {
			display: none;
		}

		.desktop-download-section {
			position: fixed;
			left: 50%;
			transform: translateX(-50%);
			bottom: 20px;
			z-index: 100;
		}

		.download-cv-button {
			@apply bg-skin-button-accent text-skin-inverted px-4 py-2 rounded-md hover:bg-skin-button-accent/80 transition-colors duration-200;
			display: inline-flex;
			align-items: center;
			border: none;
			cursor: pointer;
			font-size: 0.9rem;
			box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
		}

		.download-cv-button:hover {
			box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
		}
	}

	/* Mobile styles */
	@media (max-width: 600px) {
		#normal-footer {
			display: none;
		}

		.desktop-download-section {
			display: none;
		}

		.mobile-download-button {
			background: #fff;
			position: fixed;
			border: 1px solid #eee;
			right: 10px;
			bottom: 10px;
			width: 60px;
			height: 60px;
			border-radius: 50%;
			display: flex;
			flex-direction: column;
			align-items: center;
			justify-content: center;
			cursor: pointer;
			z-index: 1000;
			box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
			transition: all 0.2s ease;
			color: #333;
		}

		.mobile-download-button:hover {
			transform: scale(1.05);
			box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
		}

		.mobile-download-button:active {
			transform: scale(0.95);
		}

		.mobile-download-button svg {
			width: 20px;
			height: 20px;
			margin-bottom: 2px;
		}

		.mobile-download-button span {
			font-size: 10px;
			font-weight: 500;
		}

		/* Dark mode support for mobile */
		@media (prefers-color-scheme: dark) {
			.mobile-download-button {
				background: #333;
				border-color: #555;
				color: #fff;
			}
		}
	}

	footer {
		@apply bg-skin-button-accent;
		position: fixed;
		bottom: 0px;
		width: 100%;
		padding-block: 8px;
		text-align: center;
		font-size: 0.85rem;

		view-timeline-name: --revealing;
		view-timeline-axis: block;

		animation: linear 0.3s fadeIn;
		animation-timeline: --revealing;
		animation-range: entry 100% cover 10%;
	}
</style>
